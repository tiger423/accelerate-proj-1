
(py312) ve@ubuntu-105:~/llm/zero$ python accelerate_opt.py
model = facebook/opt-66b 
Loading checkpoint shards: 100%|████████████████| 14/14 [02:26<00:00, 10.49s/it]
Some parameters are on the meta device because they were offloaded to the cpu and disk.
model size= 262.878806016 GB
used time: 960.7596907615662 seconds
</s>Hugging Face is pushing the convention that a unicorn with two horns becomes a llama. So it's not surprising that the llama's expression
{'model.decoder.embed_tokens': 0, 'lm_head': 0, 'model.decoder.embed_positions': 0, 'model.decoder.final_layer_norm': 0, 'model.decoder.layers.0': 0, 'model.decoder.layers.1': 0, 'model.decoder.layers.2': 'cpu', 'model.decoder.layers.3': 'cpu', 'model.decoder.layers.4': 'cpu', 'model.decoder.layers.5': 'cpu', 'model.decoder.layers.6': 'cpu', 'model.decoder.layers.7': 'cpu', 'model.decoder.layers.8': 'cpu', 'model.decoder.layers.9': 'cpu', 'model.decoder.layers.10': 'cpu', 'model.decoder.layers.11': 'cpu', 'model.decoder.layers.12': 'cpu', 'model.decoder.layers.13': 'cpu', 'model.decoder.layers.14': 'cpu', 'model.decoder.layers.15': 'cpu', 'model.decoder.layers.16': 'disk', 'model.decoder.layers.17': 'disk', 'model.decoder.layers.18': 'disk', 'model.decoder.layers.19': 'disk', 'model.decoder.layers.20': 'disk', 'model.decoder.layers.21': 'disk', 'model.decoder.layers.22': 'disk', 'model.decoder.layers.23': 'disk', 'model.decoder.layers.24': 'disk', 'model.decoder.layers.25': 'disk', 'model.decoder.layers.26': 'disk', 'model.decoder.layers.27': 'disk', 'model.decoder.layers.28': 'disk', 'model.decoder.layers.29': 'disk', 'model.decoder.layers.30': 'disk', 'model.decoder.layers.31': 'disk', 'model.decoder.layers.32': 'disk', 'model.decoder.layers.33': 'disk', 'model.decoder.layers.34': 'disk', 'model.decoder.layers.35': 'disk', 'model.decoder.layers.36': 'disk', 'model.decoder.layers.37': 'disk', 'model.decoder.layers.38': 'disk', 'model.decoder.layers.39': 'disk', 'model.decoder.layers.40': 'disk', 'model.decoder.layers.41': 'disk', 'model.decoder.layers.42': 'disk', 'model.decoder.layers.43': 'disk', 'model.decoder.layers.44': 'disk', 'model.decoder.layers.45': 'disk', 'model.decoder.layers.46': 'disk', 'model.decoder.layers.47': 'disk', 'model.decoder.layers.48': 'disk', 'model.decoder.layers.49': 'disk', 'model.decoder.layers.50': 'disk', 'model.decoder.layers.51': 'disk', 'model.decoder.layers.52': 'disk', 'model.decoder.layers.53': 'disk', 'model.decoder.layers.54': 'disk', 'model.decoder.layers.55': 'disk', 'model.decoder.layers.56': 'disk', 'model.decoder.layers.57': 'disk', 'model.decoder.layers.58': 'disk', 'model.decoder.layers.59': 'disk', 'model.decoder.layers.60': 'disk', 'model.decoder.layers.61': 'disk', 'model.decoder.layers.62': 'disk', 'model.decoder.layers.63': 'disk'}

